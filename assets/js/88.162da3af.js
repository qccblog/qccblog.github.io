(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{671:function(s,a,t){"use strict";t.r(a);var n=t(17),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("Caddy 是一款基于 Go 语言编写的强大且可扩展的平台，可以给你的站点、服务和应用程序提供服务。")])]),s._v(" "),t("p",[s._v("如果只是想要一个 web 服务或者代理服务器，一般情况下使用 nginx 完全可以满足需求。但是如果是对外提供服务的站点，在现在浏览器环境下如果不配置 ssl，看起来就像是个不正规的网站，之前在 "),t("RouterLink",{attrs:{to:"/views/blog/2020/各种使用免费 ssl 证书的姿势.html"}},[s._v("各种使用免费 ssl 证书的姿势")]),s._v(" 中提到过很多使用免费 ssl 证书的方法，其中最推荐大家使用的还是 Let’s Encrypt 的证书服务，但是有一个很现实的问题是使用起来太麻烦了，不仅要安装 Certbot，还要获取证书、定期更新等操作。")],1),s._v(" "),t("p",[s._v("如果有一个 web 服务器只要简单配置，并且灰自动处理 SSL 证书申请续费这些问题用起来岂不是很方便？直到发现了 "),t("a",{attrs:{href:"https://caddyserver.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Caddy"),t("OutboundLink")],1),s._v(" 才知道这种东西原来真的时存在的，并且配置 https 真的很简单。")]),s._v(" "),t("blockquote",[t("p",[s._v("Caddy 是第一个也是唯一一个 "),t("em",[s._v("默认")]),s._v(" 自动使用 HTTPS 的 Web 服务器")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 HTTPS 提供静态文件")]),s._v("\n$ caddy file-server --domain example.com\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基于HTTPS的简单反向代理")]),s._v("\n$ caddy reverse-proxy --from example.com --to localhost:9000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("只要在配置中提供了主机名，Caddy 默认对所有站点使用 HTTPS。看起来果然很简单，实际操作起来也很方便，下面给出一套简单的流程，更多配置建议参考 "),t("a",{attrs:{href:"https://caddyserver.com/docs/getting-started",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("p",[s._v("以在 Ubuntu 上安装为例，其他版本安装请参考 "),t("a",{attrs:{href:"https://caddyserver.com/docs/install",target:"_blank",rel:"noopener noreferrer"}},[s._v("install"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu安装")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y debian-keyring debian-archive-keyring apt-transport-https\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -1sLf "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://dl.cloudsmith.io/public/caddy/stable/gpg.key'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/apt/trusted.gpg.d/caddy-stable.asc\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -1sLf "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/apt/sources.list.d/caddy-stable.list\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" caddy\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),t("p",[s._v("使用包安装完成后，默认情况下配置文件位置为 "),t("code",[s._v("/etc/caddy/Caddyfile")]),s._v("，支持 JSON 和 Caddyfile 文件两种配置文件，还可以通过调用 localhost: 2019 相关 api 操作。Caddyfile 文件写起来更友好一些，以此为例。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个配置文件")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Caddyfile\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("如果是单个站点")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v('localhost\n\nrespond "Hello'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" world"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!")]),s._v('"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("如果是多个站点")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("localhost "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n  respond "Hello'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" world"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!")]),s._v('"\n'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nlocalhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("2016 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n  respond "Goodbye'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" world"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!")]),s._v('"\n'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("保存并从 Caddyfile 所在的同一文件夹中通过 "),t("code",[s._v("caddy run")]),s._v(" 来运行 Caddy，由于要使用 HTTPS，所以可能会要要求输入密码，如果是普通用户启动可能会报权限错误，需要提升权限后操作。")]),s._v(" "),t("p",[s._v("如果提示配置文件格式不正确，可以通过 "),t("code",[s._v("caddy fmt --overwrite Caddyfile")]),s._v(" 格式化配置文件。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl或浏览器直接访问")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://localhost\nHello, world"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"反向代理实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反向代理实例"}},[s._v("#")]),s._v(" 反向代理实例")]),s._v(" "),t("p",[s._v("配置 www.example.com 重定向到 example.com，反向代理到 localhost: 5000。")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[s._v("www.example.com "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  redir https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//example.com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("uri"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nexample.com "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  reverse_proxy localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("通过以上示例都可以看出来 Caddy 是一个简单实用的工具，虽然现在有些人在说比 Nginx 强多少或者替代之类的还不能轻易的下结论，毕竟 Nginx 的强大是有目共睹的，是否正真能撼动 Nginx 的霸主地位还需要时间的检验。不过在某些情况下，比如只是简单的一个代理或者静态服务器，但是又需要配置 ssl 的 i 情况下，试试 Caddy 不失为一个不错的方案。有兴趣的都可以试试，真的挺简单方便的。")]),s._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://caddyserver.com/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Caddy Documentation"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://caddy2.dengxiaolong.com/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Caddy v2 中文文档"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);