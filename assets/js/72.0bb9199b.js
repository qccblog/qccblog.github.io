(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{655:function(t,s,e){"use strict";e.r(s);var r=e(17),n=Object(r.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("不管从哪方面来看，都能看到浏览器支持 https 的协议的决心是愈发坚定的，从最初的 https 协议显示绿色小锁图标来表示更安全到现在非 https 直接提示不安全，不管是从网站的安全还是体验的优化上看部署 https 都是必要且紧急的。https 从刚出现的时候可能还有各种抵触，但随着部分平台强制要求以及 SEO 优势等诸多措施实施之后，从以前寥寥几个 https 变成现在想找个正儿八经的 http 网站都很难。")]),t._v(" "),e("p",[t._v("当前通过 Chrome 访问 https 网站会显示一个小锁图标，点击小锁图标会提示用户当前连接是安全，可以放心输入各种信息。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/13/oaGrB6siQCD8n9V.png",alt:"image.png"}})]),t._v(" "),e("p",[t._v("Chrome 访问 http 网站会提示不安全，点击不安全就会说连接不安全，不要输入任何敏感信息，看到这个用户输入个密码都还要考虑一下。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/13/CKkFZYTWXDips5t.png",alt:"image.png"}})]),t._v(" "),e("h2",{attrs:{id:"获取-ssl-证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取-ssl-证书"}},[t._v("#")]),t._v(" 获取 SSL 证书")]),t._v(" "),e("p",[t._v("网站要上 https 的第一步就是先获取一个 SSL 证书，然后再部署到服务器上，配置成功后通过 "),e("code",[t._v("https://")]),t._v(" 访问即可。")]),t._v(" "),e("p",[t._v("SSL 证书由浏览器中受信任的根证书颁发机构在验证服务器身份后颁发，具有网站身份验证和加密传输双重功能。理论上，我们自己也可以手动制作一个 SSL 安全证书，但是我们自己签发的安全证书并不会被浏览器所信任，只有被信任的证书授权中心（CA）签发的安全证书才会被浏览器所信任。正常情况下去服务商获取 SSL 证书服务都需要付费，并且价格还不便宜（价位从几千到几万都有）。")]),t._v(" "),e("p",[t._v("2013 年 5 月由 Mozilla、Cisco、Akamai、IdenTrust、EFF 等组织人员发起了一个叫 "),e("a",{attrs:{href:"https://www.abetterinternet.org/about/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ISRG"),e("OutboundLink")],1),t._v("（Internet Security Research Group）的公益组织，这个组织从 2015 年开始推出了 "),e("a",{attrs:{href:"https://letsencrypt.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Let’s Encrypt"),e("OutboundLink")],1),t._v(" 作为 CA 提供免费证书，可以通过 "),e("a",{attrs:{href:"https://letsencrypt.org/zh-cn/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("快速入门"),e("OutboundLink")],1),t._v(" 了解怎么快速获取证书。")]),t._v(" "),e("h3",{attrs:{id:"certbot-获取免费证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#certbot-获取免费证书"}},[t._v("#")]),t._v(" Certbot 获取免费证书")]),t._v(" "),e("p",[t._v("Certbot 支持多种方式进行安装，可以在 "),e("a",{attrs:{href:"https://certbot.eff.org/docs/install.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get Certbot"),e("OutboundLink")],1),t._v(" 获取到各自情况下的安装方式以及常见问题的提示。通过 "),e("a",{attrs:{href:"https://certbot.eff.org/instructions",target:"_blank",rel:"noopener noreferrer"}},[t._v("certbot"),e("OutboundLink")],1),t._v(" 可以获取几种常见情况下怎么配置 SSL 证书，选择服务器所使用的软件和系统环境，然后就会显示对应版本的安装方法。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/tbR7x2QeBX59lgk.png",alt:"ssl-certbot-1.png"}}),t._v(" "),e("img",{attrs:{src:"https://i.loli.net/2020/04/09/m4G1SKPl6XMQ9Wp.png",alt:"ssl-certbot-2.png"}})]),t._v(" "),e("p",[t._v("获取免费的 SSL 证书之前需要先配置好 80 端口的 http 服务可以正常访问。以 Nginx + Ubuntu16 获取单域名的 SSL 证书为例：")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加Certbot的PPA")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" software-properties-common\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository universe\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository ppa:certbot/certbot\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装Certbot")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" certbot python-certbot-nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只是获取证书")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot certonly --nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取证书并自动安装")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot --nginx\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br")])]),e("p",[t._v("获取证书的过程中需要输入邮箱，然后会自动读取 nginx 的配置文件，如果配置了多个会让选择针对哪个生效或者全部生效。生成的证书相关的文件都在 "),e("code",[t._v("/etc/letsencrypt/live/$domain")]),t._v(" 里面，其中 privkey.pem 是证书的私钥，fullchain.pem 是包含了全部的证书。如果选择 http 重定向到 https，配置完成后直接刷新一下页面即可，否则需要把 http 改成 https 进行访问，如果可以访问则代表配置成功。")]),t._v(" "),e("p",[t._v("配置成功之后会自动修改 nginx 的配置文件，然后重启 nginx 服务，不需要手动处理。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/jMpZYkvlsU2cQDG.png",alt:"ssl-certbot-4.png"}})]),t._v(" "),e("p",[t._v("配置成功后访问 https 的网址，点击小锁图标可以看到证书相关的信息。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/pQLTvIJZmVDFxdy.png",alt:"ssl-certbot-3.png"}})]),t._v(" "),e("p",[t._v("一些常用命令")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看证书")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot certificates\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("可以通过 "),e("code",[t._v("certbot --help")]),t._v(" 查看命令或者在 "),e("a",{attrs:{href:"https://certbot.eff.org/docs/using.html#certbot-command-line-options",target:"_blank",rel:"noopener noreferrer"}},[t._v("全部命令参数"),e("OutboundLink")],1),t._v(" 查看。")]),t._v(" "),e("h4",{attrs:{id:"certbot-auto"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#certbot-auto"}},[t._v("#")]),t._v(" Certbot-Auto")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://dl.eff.org/certbot-auto\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" certbot-auto /usr/local/bin/certbot-auto\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" root /usr/local/bin/certbot-auto\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" 0755 /usr/local/bin/certbot-auto\n/usr/local/bin/certbot-auto --help\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("p",[t._v("certbot-auto 实际上是对 certbot 命令的一层包装，支持 certbot 的全部参数。")]),t._v(" "),e("h4",{attrs:{id:"docker-获取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-获取"}},[t._v("#")]),t._v(" docker 获取")]),t._v(" "),e("p",[t._v("可以通过 docker 获取证书，然后手动安装。")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run -it --rm --name certbot "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n            -v "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/letsencrypt:/etc/letsencrypt"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n            -v "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/lib/letsencrypt:/var/lib/letsencrypt"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n            certbot/certbot certonly\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("h4",{attrs:{id:"获取通配符型证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取通配符型证书"}},[t._v("#")]),t._v(" 获取通配符型证书")]),t._v(" "),e("p",[t._v("如果有很多二级域名都要配置 SSL 证书，那么每个都单独处理就比较麻烦了，完全可以申请一个通配符型的证书来处理所有的子域名。")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 手动配置")]),t._v("\ncertbot certonly --manual --preferred-challenges"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dns -d *.abc.com -d abc.com\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("可能需要手动设置 Let’s Encrypt’s ACMEv2 服务器的地址，加上参数 "),e("code",[t._v("--server https://acme-v02.api.letsencrypt.org/directory")]),t._v(" 即可。")]),t._v(" "),e("p",[t._v("执行这个命令后，会生成一条 TXT 记录的名称为 "),e("code",[t._v("_acme-challenge")]),t._v(" 和 Value 值，需要在域名解析的地方加上这个配置。检测通过之后就会成功生成证书，证书存放在 "),e("code",[t._v("/etc/letsencrypt/live/abc.com/")]),t._v(" 里。")]),t._v(" "),e("h4",{attrs:{id:"更新证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新证书"}},[t._v("#")]),t._v(" 更新证书")]),t._v(" "),e("p",[t._v("默认生成的证书有效期都是三个月，但是可以无限续签，在过期前会有邮件通知，可以通过 renew 命令进行续订")]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 续订")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot renew\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h3",{attrs:{id:"通过一些网站获取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通过一些网站获取"}},[t._v("#")]),t._v(" 通过一些网站获取")]),t._v(" "),e("p",[t._v("如果还是觉得上面通过命令行申请证书比较麻烦不好操作，那么可以通过一些网站进行申请。"),e("a",{attrs:{href:"https://freessl.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("freessl"),e("OutboundLink")],1),t._v(" 是一个提供免费 HTTPS 证书申请的网站，个人觉得这个网站不错。可以注册双域名一年有效期的亚洲诚信和多域名通配符三个月有效期的 Let’s Encrypt 的两种免费证书。")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.sslforfree.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSL FOR FREE"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://www.upyun.com/products/ssl",target:"_blank",rel:"noopener noreferrer"}},[t._v("又拍云"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://www.pianyissl.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("便宜 SSL"),e("OutboundLink")],1),t._v(" 等一些商家也都有提供免费的的 SSL 证书。诸如 "),e("a",{attrs:{href:"https://help.aliyun.com/document_detail/148895.html?spm=a2c4g.11186623.4.4.555617cey494N4",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云"),e("OutboundLink")],1),t._v(" 等云服务提供商也都有免费证书可以申请，如果域名是在云服务商建议优先使用其提供的证书。")]),t._v(" "),e("p",[t._v("申请免费 SSL 证书一般步骤都类似，以 freessl 演示怎么申请：")]),t._v(" "),e("ol",[e("li",[t._v("首先填写需要申请 SSL 证书的域名，不同的证书填写的规则略有区别。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/pVutiZz1DHAMCKd.png",alt:"ssl-web-1.png"}})]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("选择验证方式，SSL 证书都是要验证你对这个域名拥有所有权，严格的付费证书还有人工验证环节。这边选择 DNS 进行验证。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/YaJ92h5tTDocMPB.png",alt:"ssl-web-2.png"}})]),t._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[t._v("获取验证信息")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/09/VzMnUTIj1ipw2Q4.png",alt:"ssl-web-3.png"}})]),t._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[t._v("进行验证。进入域名解析的控制台，新增一条 TXT 记录填入上一步获取到的信息。配置成功之后点击验证，验证成功之后就会显示证书信息，可以下载到本地保存。")])]),t._v(" "),e("h3",{attrs:{id:"关于各种证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关于各种证书"}},[t._v("#")]),t._v(" 关于各种证书")]),t._v(" "),e("h4",{attrs:{id:"自签名证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自签名证书"}},[t._v("#")]),t._v(" 自签名证书")]),t._v(" "),e("p",[t._v("除了免费的 SSL 证书之外，还有一种自签名的证书。自签名证书签发很方便，但是使用起来确实很麻烦，除了浏览器会弹出不安全的提示外还有一些安全方面的问题。自签证书容易被假冒和伪造，而被欺诈网站所利用；容易受到 SSL 中间人攻击；自签证书没有可访问的吊销列表；自签证书证书有效期太长，有效期越长就越有可能被黑客破解。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/13/OegStzvLD2ZsaNI.png",alt:"ssl-1.png"}})]),t._v(" "),e("p",[t._v("Chrome 下访问会首先提示不安全，不过可以通过高级选项强行访问，不过即使能进去还是会提示不安全，样式上起来比 http 还不安全。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/13/hlj2gqxdQ8iUtnR.png",alt:"ssl-2.png"}})]),t._v(" "),e("p",[t._v("除了 Chrome 外，其他浏览器的表现也都大同小异。甚至于 IE 在某些情况下即使手动选择信任都存在问题。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.loli.net/2020/04/13/DuRGkEMrcTZs94x.png",alt:"image.png"}})]),t._v(" "),e("h4",{attrs:{id:"相比较付费-ssl-证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#相比较付费-ssl-证书"}},[t._v("#")]),t._v(" 相比较付费 SSL 证书")]),t._v(" "),e("p",[t._v("免费 SSL 证书只有域名型（DV）证书，仅用于提供基本级别的身份验证，仅适合个人类网站。而付费的 SSL 证书则有组织验证（OV）和扩展验证（EV）证书，验证级别较高，相应的安全等级也较高，对于安全需求较高的网站来说更适合。"),e("strong",[t._v("免费证书仅适用于个人网站业务或测试用户，建议商业化的网站或企业、机构等网站使用收费证书。即便要使用免费证书建议尽可能使用云服务商提供的免费证书或者直接使用 certbot 申请。")])]),t._v(" "),e("h3",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://certbot.eff.org/lets-encrypt/ubuntuxenial-nginx",target:"_blank",rel:"noopener noreferrer"}},[t._v("certbot"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/80909555",target:"_blank",rel:"noopener noreferrer"}},[t._v("Certbot-免费的 HTTPS 证书"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);