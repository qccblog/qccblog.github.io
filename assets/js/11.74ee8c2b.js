(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{594:function(s,a,e){"use strict";e.r(a);var t=e(17),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("在开发网站的时候，如果用到一些新的功能或者某些比较敏感的信息的时候，谷歌浏览器会拒绝非https的请求，火狐浏览器也有类似的限制。因此，如果对一些HTML5特性比较感兴趣的话，有必要配置一个本地开发环境使用的SSL证书。可以使用openssl自己生成的证书来配置ssl，当然，这种证书是不受操作系统信任的，但是对本地开发是没有问题的。"),e("br"),s._v("\n本文实在Ubuntu 16.04的环境下配置的，域名为admin.mydomain.com。")]),s._v(" "),e("h2",{attrs:{id:"生成证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#生成证书"}},[s._v("#")]),s._v(" 生成证书")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#选择存放证书的目录，自由选择")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/apache2/ssl\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用openssl生成密钥privkey.pem，可以加上 -des3参数来加密")]),s._v("\nopenssl genrsa -out privkey.pem "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用密钥生成证书public.pem")]),s._v("\nopenssl req -new -x509 -key privkey.pem -days "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("730")]),s._v(" -out public.pem\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在生成证书的时候，需要一步步的填写相关的信息，可以使用默认的信息。在填写"),e("code",[s._v("Common Name (e.g. server FQDN or YOUR name) []:")]),s._v("的时候，推荐使用"),e("code",[s._v("*.youdomain.com")]),s._v("这种通配符的形式来匹配，这样就不用以后有了新的子站还需要再生成一份新的证书。")]),s._v(" "),e("h2",{attrs:{id:"配置apache2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置apache2"}},[s._v("#")]),s._v(" 配置Apache2")]),s._v(" "),e("p",[s._v("没有直接强制要求所有的访问都是https形式的，因此，可以单独配置一个443端口的配置文件。")]),s._v(" "),e("h3",{attrs:{id:"开启apache2的ssl模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开启apache2的ssl模块"}},[s._v("#")]),s._v(" 开启Apache2的ssl模块")]),s._v(" "),e("p",[e("code",[s._v("sudo a2enmod ssl")])]),s._v(" "),e("h3",{attrs:{id:"配置ssl访问443端口的配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置ssl访问443端口的配置文件"}},[s._v("#")]),s._v(" 配置SSL访问443端口的配置文件")]),s._v(" "),e("p",[s._v("在"),e("code",[s._v("/etc/apache2/sites-available")]),s._v("下新建一个"),e("code",[s._v("admin.mydomain-ssl.com")]),s._v("文件，")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IfModule mod_ssl.c"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VirtualHost *:44"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v(">")]),s._v("\n    ServerName admin.mydomain.com\n    DocumentRoot /var/www/mydomain/admin\n    SSLCertificateFile /etc/apache2/ssl/server.pem\n    SSLCertificateKeyFile /etc/apache2/ssl/privkey.pem\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/VirtualHost"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/IfModule"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("软链接到"),e("code",[s._v("/etc/apache2/sites-enabled")]),s._v("下面以启用该配置。重启服务器就可以了，本地hosts加上就可以试着去访问了。多域名配置在其他文章里有介绍。")]),s._v(" "),e("h2",{attrs:{id:"本机信任该证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本机信任该证书"}},[s._v("#")]),s._v(" 本机信任该证书")]),s._v(" "),e("p",[s._v("一切配置ok，在浏览器访问"),e("a",{attrs:{href:"https://admin.mydomain.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://admin.mydomain.com"),e("OutboundLink")],1),s._v("，发现是一个红叉，告诉这是一个不受信任的证书。这时候就需要自己动手去信任该证书了。"),e("br"),s._v("\n1. 在"),e("code",[s._v("60.0.3112.90")]),s._v("版本的谷歌浏览器，如果你已经打开了这个页面会发现右键不出来东西，默默使用"),e("code",[s._v("shift+ctrl+i")]),s._v("来打开调试找到"),e("code",[s._v("Security")]),s._v("选项，点击"),e("code",[s._v("View certificate")]),s._v("查看证书会发现是不受操作系统信任的小黑作坊生产的证书。"),e("br"),s._v("\n2. 点击详细信息里面的复制到文件，一步步确认，最后一步点"),e("code",[s._v("浏览")]),s._v("选择保存的位置和文件名，桌面就行。"),e("br"),s._v("\n3. 在桌面找到证书文件，双击安装，选择安装证书，需要注意的是，在证书存储选择的时候一定要选择"),e("br"),s._v(" "),e("code",[s._v("受信任的根证书颁发机构")]),s._v("，不然浏览器还是不认的。")]),s._v(" "),e("p",[s._v("现在去访问就可以了，可以去试各种需要SSL权限的操作了。。。")])])}),[],!1,null,null,null);a.default=n.exports}}]);